/*!
 * responsiveCarousel
 * A responsive carousel that works in desktop browsers, ipad, iphone, and even
 * most Androids.  It uses css3 animations with a jquery animation fallback for
 * greater speed.  The code was optimized to minimize page reflows to further
 * enhance the overall speed.  Doesn't try and solve everything, small and
 * compact for specific use..
 *
 * This is a jQuery UI Widget
 *
 * @version 0.4.0
 * @releaseDate 1/10/2013
 * @author Matthew Toledo
 * @url https://github.com/mrbinky3000/responsive_carousel
 * @requires jQuery, jQuery UI (only the Core and Widget Factory), modernizr (only css3 transitions test, touch test optional), hammer.js
 */
(function(f,k,p){var j=!1;f.widget("ri.responsiveCarousel",{options:{arrowLeft:".arrow-left a",arrowRight:".arrow-right a",target:".slider-target",mask:".slider-mask",unitElement:"li",unitWidth:"inherit",responsiveUnitSize:null,onRedraw:null,dragEvents:!1,speed:400,slideSpeed:2500,step:-1,responsiveStep:null,onShift:null,cssAnimations:Modernizr.csstransitions,nudgeThreshold:10},internal:{currentSlide:0,left:0,targetWidth:0,unitWidth:0,targetOuterWidth:0,targetOuterHeight:0,targetParentOuterWidth:0,
targetParentInnerWidth:0,targetParentOuterHeight:0,targetParentMarginLeft:0,targetBackupCopy:null,isArrowBeingClicked:!1,arrowLeftVisible:!0,arrowRightVisible:!0,targetLeft:0,timer:null,firstMouseClick:!1,prefix:null,slideShowActive:!1,slideTimer:null,slideBumped:!1,nudgeDirection:null,infinite:!0},wait:function(){var a;return{thenDo:function(b,c){"undefined"!==typeof a&&k.clearTimeout(a);a=k.setTimeout(b,c)}}},_getPrefix:function(a){for(var b=["Moz","Webkit","Khtml","0","ms"],c=p.createElement("div"),
e=a.charAt(0).toUpperCase()+a.slice(1),d="",f=b.length;-1<f;)"undefined"!==typeof c.style[b[f]+e]&&(d=b[f]),f-=1;c.style[a]&&(d=a);return"-"+d.toLowerCase()+"-"},_animate:function(a,b,c,e){var d=this.options,h=this.internal;return a.each(function(){var a=f(this),j=h.prefix;d.cssAnimations?(a.css(j+"transition","all "+c/1E3+"s ease-in-out").css(b),k.setTimeout(function(){a.css(j+"transition","");f.isFunction(e)&&e()},c)):a.animate(b,c,function(){f.isFunction(e)&&e()})})},_setTargetWidth:function(){var a=
this.internal,b=this.options,c=f(this.element),e=f(this.element).find(b.target);a.targetWidth=e.find(b.unitElement).length*a.unitWidth;c.find(b.target).width(a.targetWidth);a.targetOuterWidth=e.outerWidth();a.targetOuterHeight=e.outerHeight();a.targetParentOuterWidth=e.parent().outerWidth();a.targetParentInnerWidth=e.parent().innerWidth();a.targetParentOuterHeight=e.parent().outerHeight();a.targetParentMarginLeft=parseInt(e.parents().css("marginLeft"),10);isNaN(a.targetParentMarginLeft)&&(a.targetParentMarginLeft=
0)},_setArrowVisibility:function(){var a=this.options,b=this.internal,c=f(this.element).find(a.target),e=c.position().left,d=b.targetOuterWidth+e,h=f(this.element).find(a.arrowLeft),g=f(this.element).find(a.arrowRight);d<=b.targetParentOuterWidth?(g.hide(),!0===b.isArrowBeingClicked&&this._clearInterval(),b.arrowRightVisible=b.isArrowBeingClicked=!1):!1===b.arrowRightVisible&&(g.show(),b.arrowRightVisible=!0);0<=e?(h.hide(),!0===b.isArrowBeingClicked&&this._clearInterval(),b.arrowLeftVisible=b.isArrowBeingClicked=
!1):!1===b.arrowLeftVisible&&(h.show(),b.arrowLeftVisible=!0);b.currentSlide=f(c.find(a.unitElement)[Math.abs(e/b.unitWidth)]).data("slide");if(f.isFunction(a.onShift))a.onShift(b.currentSlide)},_clearInterval:function(){var a=this.internal,b=this.options,c=f(this.element).find(b.target);"number"===typeof a.timer&&(a.isArrowBeingClicked=!1,k.clearInterval(a.timer));!1===j&&(j=!0,this._animate(c,{left:this.computeAdjust(c)},b.speed,function(){j=!1}))},_doArrowBeingClicked:function(a){var b=this,c=
this.internal,e=this.options,d=f(this.element).find(e.target),h=d.position().left,g=c.targetParentMarginLeft;if(!0!==j){if("left"===a)a=h-g+c.unitWidth;else if("right"===a)a=h-g-c.unitWidth;else throw Error("unknown direction");j=!0;this._animate(d,{left:a},e.speed,function(){b._setArrowVisibility();j=!1})}},_setArrowEvents:function(){var a=this,b=this.options,c=this.internal,e=f(this.element).find(b.arrowLeft),d=f(this.element).find(b.arrowRight),h="",g="";e.on("click.responsiveCarousel",function(a){a.preventDefault()});
d.on("click.responsiveCarousel",function(a){a.preventDefault()});!0===b.dragEvents?(h="mousedown.responsiveCarousel touchstart.responsiveCarousel",g="mouseup.responsiveCarousel touchend.responsiveCarousel"):(h="mousedown.responsiveCarousel",g="mouseup.responsiveCarousel");e.on(h,function(b){b.preventDefault();!1===j&&(c.isArrowBeingClicked=c.firstMouseClick=!0,c.timer=k.setInterval(function(){a._doArrowBeingClicked("left")},10),c.slideTimer&&(k.clearInterval(c.slideTimer),c.slideShowActive=!1))});
d.on(h,function(){!1===j&&(c.isArrowBeingClicked=c.firstMouseClick=!0,c.timer=k.setInterval(function(){a._doArrowBeingClicked("right")},10),c.slideTimer&&(k.clearInterval(c.slideTimer),c.slideShowActive=!1))});f(this.element).on(g,function(){!0===c.isArrowBeingClicked&&a._clearInterval()})},_setUnitWidth:function(){var a,b,c=this,e=this.internal,d=this.options,h=f(this.element).find(d.target),g=f(this.element),j=h.find(d.unitElement).eq(0),m=new this.wait,l=function(){e.unitWidth=j.outerWidth()},
n=function(){var c=g.find(d.mask).innerWidth();b=d.responsiveUnitSize(g,e,d);if("number"!==typeof b||1>b)throw Error("The responsiveUnitSize callback must return a whole number greater than 0");a=c/b;a=Math.floor(a);h.find(d.unitElement).css("width",a);e.unitWidth=a};if("inherit"===d.unitWidth)l(),h.find("img").on("load.responsiveCarousel",function(){l();c._setTargetWidth("inherit");c._setArrowVisibility();if(f.isFunction(d.onRedraw))d.onRedraw(g,e,d)});else if("compute"===d.unitWidth){l();f.isFunction(d.responsiveUnitSize)&&
(n(),l());if(f.isFunction(d.onRedraw))d.onRedraw(g,e,d);h.find("img").on("load",function(){f.isFunction(d.responsiveUnitSize)&&n();l();c._setTargetWidth("compute");c._setArrowVisibility();if(f.isFunction(d.onRedraw))d.onRedraw(g,e,d)});f(k).on("resize.responsiveCarousel",function(){m.thenDo(function(){f.isFunction(d.responsiveUnitSize)&&n();l();c._setTargetWidth("compute (window resize)");h.css({left:-1*e.currentSlide*e.unitWidth});c._setArrowVisibility();if(f.isFunction(d.onRedraw))d.onRedraw(g,
e,d)},100)})}else e.unitWidth=d.unitWidth},_dragEvents:function(){var a=this,b=this.options,c=this.internal,e=f(this.element).find(b.target),d=e.parent(),d=new Hammer(d.get(0),{drag:!0,drag_vertical:!1,drag_horizontal:!0,drag_min_distance:0,transform:!1,tap:!1,tap_double:!1,hold:!1}),h;d.ondragstart=function(){if(!0===c.isArrowBeingClicked||!0===j)return{};j=!0;parseInt(e.css("top"),10);h=parseInt(e.css("left"),10);(new Date).getTime()};d.ondrag=function(a){!0!==c.isArrowBeingClicked&&(c.nudgeDirection=
null,"up"===a.direction||"left"===a.direction?(a.distance=-a.distance,Math.abs(a.distance)>b.nudgeThreshold&&Math.abs(a.distance)<c.unitWidth/2&&(c.nudgeDirection="left")):a.distance>b.nudgeThreshold&&a.distance<c.unitWidth/2&&(c.nudgeDirection="right"),a=h+1*a.distance,c.left=a,e.css("left",a))};d.ondragend=function(){e.stop(!0,!1);a._animate(e,{left:a.computeAdjust(e)},b.speed,function(){a._setArrowVisibility();j=!1})}},_create:function(){var a=this.options,b=this.internal,c=f(this.element),e=f(this.element).find(a.target);
this.internal.targetBackupCopy=this.element;this.options.cssAnimations&&(this.internal.prefix=this._getPrefix("transition"));e.css({position:"relative",left:0});e.find(a.unitElement).each(function(a){f(this).attr({"data-slide":a})});!0===a.dragEvents&&this._dragEvents();this._setArrowEvents();this._setUnitWidth();this._setTargetWidth("first load");this._setArrowVisibility();if(f.isFunction(a.onRedraw))a.onRedraw(c,b,a)},redraw:function(){var a=this.internal,b=this.options,c=f(this.element);this._setUnitWidth();
this._setTargetWidth("_redraw");this._setArrowVisibility();if(f.isFunction(this.options.onRedraw))this.options.onRedraw(c,a,b)},getCurrentSlide:function(){return this.internal.currentSlide},goToSlide:function(a){var b=this,c=this.internal,e=this.options,d=f(this.element).find(e.target);this._setUnitWidth();a=-1*a*c.unitWidth;j=!0;this._animate(d,{left:a},e.speed,function(){j=!1;b._setArrowVisibility()})},toggleSlideShow:function(){var a=this,b=this.internal,c=this.options,e=f(this.element).find(c.target);
!1===b.slideShowActive?(b.slideShowActive=!0,b.slideTimer=k.setInterval(function(){var d=c.step,f=b.targetParentInnerWidth,g=e.position().left,k=g+b.targetWidth,m=g+d*b.unitWidth,d=k+d*b.unitWidth,l=m;!1===b.slideBumped?(d<=f&&(l=m+f-d,b.slideBumped="left"),0<=m&&(b.slideBumped="right",l=0)):("left"===b.slideBumped&&(l=0),"right"===b.slideBumped&&(l=g+f-k),b.slideBumped=!1);j=!0;a._animate(e,{left:l},c.speed,function(){j=!1;a._setArrowVisibility()})},c.slideSpeed)):!0===b.slideShowActive&&(b.slideShowActive=
!1,k.clearInterval(b.slideTimer))},destroy:function(){f(k).unbind(".responsiveCarousel");f(this.element).find(this.options.arrowLeft).unbind(".responsiveCarousel");f(this.element).find(this.options.arrowRight).unbind(".responsiveCarousel");this.element=this.internal.targetBackupCopy;f.Widget.prototype.destroy.call(this)},computeAdjust:function(a){var b=this.internal;a=a.position().left;var c=b.unitWidth/-2,e=b.targetParentInnerWidth,d,f=b.nudgeDirection,g=b.unitWidth;null!==f&&("left"===f&&(d=a-g),
"right"===f&&(d=a+g),a=d);b=a+b.targetWidth;b<e&&(a=d=a+e-b);0<a&&(a=d=0);b=a%this.internal.unitWidth;0!==b&&(b<c&&(d=a-(this.internal.unitWidth+b)),b>c&&(d=a-b));return d}})})(jQuery,window,document);
